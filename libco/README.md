# libco源码阅读

相比于云风的 coroutine 协程库, libco 整体更成熟，性能更高，使用上也更加方便。主要体现在以下几个方面：

协程上下文切换性能更好
协程在 IO 阻塞时可自动切换，包括 gethostname、mysqlclient 等。
协程可以嵌套创建，即一个协程内部可以再创建一个协程。
提供了超时管理，以及一套类 pthread 的接口，用于协程间通信。

# hook原理

libco支持第三方库的原因是, 因为libco协程库hook了系统的socket相关函数, 所以第三方库使用的是libco中的网络IO函数，不然进入不了协程调度
接下来分析hook的第二步，也就是如何保证第三方库调用的是libco自身实现的相关socket函数呢？
简单而言，就是通过调整最终生成的可执行文件的链接顺序，使其全局符号表中的跟socket相关函数的符号为libco协程库中的符号。